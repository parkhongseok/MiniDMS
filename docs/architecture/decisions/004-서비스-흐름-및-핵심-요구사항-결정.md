# 서비스 흐름 및 핵심 요구사항 결정

Date: 2025-04-24

## 상태

적용 중

## 맥락

본 프로젝트는 홈 네트워크 내에서 문서를 안전하게 저장하고 관리할 수 있는 경량형 DMS(Document Management System)를 구현하는 것을 목표로 한다.  
사용자는 웹 상에서 문서를 업로드하고 다운로드할 수 있으며, 각 문서는 버전별로 관리되며 복원 기능을 제공한다.  
라즈베리파이에서 실행되는 환경을 고려하여, 실시간 편집이나 클라우드 연동이 아닌 기본적인 문서 업로드/다운로드 및 버전 복원 기능에 집중한다.

또한 JSP와 jQuery를 기반으로 구현되는 만큼, 전통적인 MVC 기반 흐름에서 가능한 범위 내에서 기능을 단순화하고, RESTful보다는 명시적 URL을 사용하는 컨트롤러 구조를 채택한다.

## 결정

### 문서 업로드
- 동일 문서명이 존재할 경우 새로운 버전으로 저장
- 파일은 라즈베리파이 로컬 디렉터리에 저장
- 메타데이터는 DB에 저장되며 업로더, 업로드 시각, 파일 크기 등을 포함

### 문서 다운로드
- 사용자는 항상 최신 버전의 파일을 다운로드함
- 파일 경로는 `Document.currentVersionId` 기준으로 결정

### 문서 복원
- 사용자가 특정 이전 버전을 선택하면, 해당 버전으로 `currentVersionId`만 변경
- 이전 파일들은 삭제되지 않고 모두 유지됨

### 미리보기
- PDF, 이미지, 텍스트 파일에 한해 미리보기를 제공
- JSP에서 `<iframe>` 또는 `<div>` 태그를 이용해 브라우저 내 표시

### 권한 관리
- **Guest**: 로그인만 가능
- **User**: 문서 조회, 다운로드 가능
- **Editor**: 업로드 가능
- **Admin**: 문서 삭제 및 복원 가능

## 결과

- 문서 중심의 단순한 버전 관리 시스템의 기본 흐름이 확립됨
- JSP 기반 MVC 구조에 맞는 화면 흐름과 사용자 인터랙션 구조를 구상할 수 있었음
- 업로드/다운로드/복원 기능을 통해 DMS의 핵심 기능을 재현
- 사용자 권한 분리에 따라 보안성과 관리성을 확보할 수 있는 구조가 됨
- 추후 로컬 폴더 연동, 동기화, 클라이언트 앱 등으로의 확장이 가능해질 기반을 마련함
